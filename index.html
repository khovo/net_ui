<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>RiyalNet Bot</title>
    
    <!-- SDKs -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <!-- Ad Script (Monetag) -->
    <script src='//libtl.com/sdk.js' data-zone='10378147' data-sdk='show_10378147'></script>

    <!-- External Styles -->
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- 1. NEW LOADING SCREEN (Startup) -->
    <div id="startup-loader" class="startup-overlay">
        <div class="neon-text">WELCOME TO<br>RIYALNET BOT</div>
        <div class="spinner-box">
            <div class="neon-spinner"></div>
        </div>
        <p class="loading-text">Loading User Data...</p>
    </div>

    <!-- 2. STORY MODE AD OVERLAY (Hidden by default) -->
    <div id="story-overlay" class="story-overlay hidden">
        <div class="story-header">
            <!-- 3 Progress Bars -->
            <div class="story-bar-container">
                <div class="story-bar"><div id="bar-1" class="fill"></div></div>
                <div class="story-bar"><div id="bar-2" class="fill"></div></div>
                <div class="story-bar"><div id="bar-3" class="fill"></div></div>
            </div>
            <div class="close-story" onclick="closeStoryMode()"><i class="fas fa-times"></i></div>
        </div>

        <div class="story-content">
            <div class="ad-placeholder">
                <i class="fas fa-play-circle pulsate"></i>
                <h3 id="story-status">Watching Ad 1...</h3>
                <p>Please wait <span id="story-timer">10</span>s</p>
            </div>
            <!-- Monetag Container invisible but active -->
            <div id="monetag-container"></div>
        </div>

        <button id="btn-claim-reward" class="btn-claim hidden" onclick="claimStoryReward()">
            CLAIM +0.50 ETB
        </button>
    </div>

    <!-- HEADER -->
    <header>
        <div class="user-profile">
            <img id="u-avatar" src="https://via.placeholder.com/50" class="user-avatar" alt="User">
            <div class="user-details">
                <h3 id="u-name">Guest</h3>
                <span id="u-id">ID: ...</span>
            </div>
        </div>
        <div id="admin-icon" class="admin-badge" onclick="switchTab('admin')">
            <i class="fas fa-crown"></i>
        </div>
    </header>

    <!-- MAIN CONTENT -->
    <div id="main-content">

        <!-- HOME TAB -->
        <div id="tab-home" class="tab-view active">
            <div class="balance-card">
                <small>TOTAL BALANCE</small>
                <h1><span id="bal-amount">0.00</span> ETB</h1>
            </div>

            <!-- Ad Trigger -->
            <div class="card neon-border">
                <div class="card-icon"><i class="fas fa-tv"></i></div>
                <div class="card-text">
                    <h3>Watch Ads</h3>
                    <p>Story Mode â€¢ Earn 0.50 ETB</p>
                </div>
                <button class="btn-action" onclick="openStoryMode()">WATCH</button>
            </div>

            <!-- Stats Row -->
            <div class="stats-row">
                <div class="stat-box">
                    <i class="fas fa-eye"></i>
                    <span id="stat-ads">0</span>
                    <small>Ads</small>
                </div>
                <div class="stat-box">
                    <i class="fas fa-users"></i>
                    <span id="stat-refs">0</span>
                    <small>Refs</small>
                </div>
            </div>
        </div>

        <!-- WALLET TAB (Updated UI) -->
        <div id="tab-wallet" class="tab-view">
            <h2 class="section-title">Select Method</h2>
            
            <div class="payment-methods">
                <div id="method-telebirr" class="method-card active" onclick="selectMethod('Telebirr')">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/82/Telegram_logo.svg/1024px-Telegram_logo.svg.png" style="width:30px; filter: hue-rotate(200deg);"> 
                    <span>Telebirr</span>
                    <div class="check-mark"><i class="fas fa-check-circle"></i></div>
                </div>
                <div id="method-cbe" class="method-card" onclick="selectMethod('CBE')">
                    <i class="fas fa-university" style="font-size:30px; color:gold;"></i>
                    <span>CBE</span>
                    <div class="check-mark"><i class="fas fa-check-circle"></i></div>
                </div>
            </div>

            <div class="withdraw-form">
                <label>Details</label>
                <input id="wd-acc" type="number" placeholder="Account Number" class="neon-input">
                <input id="wd-amt" type="number" placeholder="Amount (Min 50 ETB)" class="neon-input">
                <button class="btn-main" onclick="requestWithdraw()">CONFIRM WITHDRAW</button>
            </div>
            
            <div id="wd-history" class="history-list">
                <!-- History populated by JS -->
            </div>
        </div>

        <!-- INVITE TAB (Updated UI) -->
        <div id="tab-invite" class="tab-view">
            <div class="referral-card">
                <i class="fas fa-gift big-icon"></i>
                <h2>Invite Friends</h2>
                <p>Earn 10% from every friend's revenue forever!</p>
                
                <div class="link-group">
                    <input id="ref-link" type="text" readonly value="Loading...">
                    <button onclick="copyRefLink()">COPY</button>
                </div>

                <div class="ref-stats">
                    <div>
                        <h4 id="page-ref-count">0</h4>
                        <small>Invited</small>
                    </div>
                    <div class="divider"></div>
                    <div>
                        <h4 id="page-ref-earn">0.00</h4>
                        <small>Earned</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- ADMIN TAB -->
        <div id="tab-admin" class="tab-view">
            <h2 style="color: gold; text-align: center; margin-bottom: 20px;">Admin Panel ðŸ”’</h2>
            <div class="admin-controls">
                <button class="admin-btn" onclick="toggleMaintenance()">Toggle Maintenance</button>
                <button class="admin-btn" onclick="fetchAdminData()">Refresh</button>
            </div>
            <div id="adm-withdrawals">Loading...</div>
            <div class="admin-panel" style="margin-top:20px">
                <input id="adm-target-id" placeholder="User ID" class="neon-input">
                <button class="admin-btn red" onclick="banUser()">Ban User</button>
            </div>
        </div>

    </div>

    <!-- Navigation -->
    <nav class="bottom-nav">
        <div class="nav-item active" onclick="switchTab('home', this)"><i class="fas fa-home"></i>Home</div>
        <div class="nav-item" onclick="switchTab('invite', this)"><i class="fas fa-user-plus"></i>Invite</div>
        <div class="nav-item" onclick="switchTab('wallet', this)"><i class="fas fa-wallet"></i>Wallet</div>
        <div class="nav-item hidden" id="nav-admin" onclick="switchTab('admin', this)"><i class="fas fa-shield-alt"></i>Admin</div>
    </nav>

    <!-- External Script -->
    <script src="script.js"></script>
</body>
</html>
